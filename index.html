import React, { useState } from 'react';
import ReactDOM from 'react-dom';
import { Button, TextField, Checkbox, FormControlLabel, Grid, Box, Typography, Card, CardContent, CardHeader, CircularProgress } from '@mui/material';
import { BookOpen, CheckCircle2, Rocket, Image as IconImage } from 'lucide-react';  // Используем иконки для этапов проекта

// Данные для этапов проекта
const stages = [
  { key: 'brief', title: 'Бриф', icon: BookOpen, eta: '1–2 дня', progress: 80 },
  { key: 'discovery', title: 'Исследование', icon: BookOpen, eta: '3–5 дней', progress: 60 },
  { key: 'brand', title: 'Брендинг', icon: IconImage, eta: '5–7 дней', progress: 35 },
  { key: 'design', title: 'Дизайн сайта', icon: IconImage, eta: '7–10 дней', progress: 20 },
  { key: 'dev', title: 'Разработка', icon: Rocket, eta: '10–14 дней', progress: 10 },
  { key: 'handoff', title: 'Сдача', icon: CheckCircle2, eta: '1 день', progress: 0 },
];

// Страница авторизации
const AuthPage = ({ onLoginSuccess }) => {
  const [role, setRole] = useState('');
  const [rememberMe, setRememberMe] = useState(false);
  const [login, setLogin] = useState('');
  const [password, setPassword] = useState('');

  const handleLogin = () => {
    if (role && login && password) {
      onLoginSuccess(role);
    } else {
      alert('Заполните все поля!');
    }
  };

  return (
    <Box sx={{ maxWidth: 400, margin: '0 auto', padding: 2 }}>
      <Typography variant="h5" align="center" gutterBottom>Авторизация</Typography>
      <FormControlLabel
        control={<Checkbox checked={role === 'client'} onChange={() => setRole('client')} />}
        label="Заказчик"
      />
      <FormControlLabel
        control={<Checkbox checked={role === 'team'} onChange={() => setRole('team')} />}
        label="Член команды"
      />
      <TextField
        label="Логин"
        value={login}
        onChange={(e) => setLogin(e.target.value)}
        fullWidth
        margin="normal"
      />
      <TextField
        label="Пароль"
        type="password"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
        fullWidth
        margin="normal"
      />
      <FormControlLabel
        control={<Checkbox checked={rememberMe} onChange={() => setRememberMe(!rememberMe)} />}
        label="Запомнить меня"
      />
      <Button variant="contained" color="primary" onClick={handleLogin} fullWidth sx={{ marginTop: 2 }}>
        Войти
      </Button>
    </Box>
  );
};

// Страница заказчика (Dashboard)
const ClientDashboard = () => (
  <Box sx={{ padding: 3 }}>
    <Typography variant="h4" gutterBottom>Кабинет заказчика</Typography>
    <Grid container spacing={3}>
      <Grid item xs={12} md={8}>
        {stages.map((stage) => (
          <Card key={stage.key} sx={{ marginBottom: 2 }}>
            <CardHeader
              title={stage.title}
              subheader={`ETA: ${stage.eta}`}
              action={<CircularProgress variant="determinate" value={stage.progress} size={40} />}
            />
            <CardContent>
              <Box display="flex" justifyContent="space-between" alignItems="center">
                <Box display="flex" alignItems="center">
                  <stage.icon className="w-6 h-6 text-teal-600" />
                  <Typography variant="body2" sx={{ marginLeft: 1 }}>{stage.title}</Typography>
                </Box>
                <Box width="60%">
                  <Box sx={{ height: 10, backgroundColor: '#ddd', borderRadius: '5px' }}>
                    <Box sx={{
                      height: '100%',
                      width: `${stage.progress}%`,
                      backgroundColor: '#4caf50',
                      borderRadius: '5px'
                    }} />
                  </Box>
                </Box>
              </Box>
            </CardContent>
          </Card>
        ))}
      </Grid>
      <Grid item xs={12} md={4}>
        <Card>
          <CardHeader title="Мои материалы" subheader="Все логотипы, шрифты и цвета проекта" />
          <CardContent>
            <Box className="grid grid-cols-2 gap-2">
              <div className="h-24 bg-gray-300 rounded-xl"></div>
              <div className="h-24 bg-gray-300 rounded-xl"></div>
            </Box>
          </CardContent>
        </Card>
      </Grid>
    </Grid>
  </Box>
);

// Страница члена команды (Kanban board)
const TeamDashboard = () => (
  <Box sx={{ padding: 3 }}>
    <Typography variant="h4" gutterBottom>Кабинет члена команды</Typography>
    <Grid container spacing={3}>
      <Grid item xs={12}>
        <Card>
          <CardHeader title="Проект 1" subheader="Текущие задачи" />
          <CardContent>
            <ul>
              <li>Задача 1</li>
              <li>Задача 2</li>
              <li>Задача 3</li>
            </ul>
          </CardContent>
        </Card>
      </Grid>
    </Grid>
  </Box>
);

// Главный компонент для управления состоянием
const App = () => {
  const [role, setRole] = useState('');
  const [authPage, setAuthPage] = useState(true);

  const handleLoginSuccess = (role) => {
    setRole(role);
    setAuthPage(false);
  };

  return (
    <div className="app">
      {authPage ? (
        <AuthPage onLoginSuccess={handleLoginSuccess} />
      ) : role === 'client' ? (
        <ClientDashboard />
      ) : (
        <TeamDashboard />
      )}
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('root'));

