import React, { useState } from 'react';
import ReactDOM from 'react-dom';
import { Button, Input, Checkbox, FormControlLabel, TextField, Card, CardContent, CardHeader, CardTitle, CardDescription, Grid, Box } from '@mui/material';
import { BookOpen, CheckCircle2, Rocket, Image as IconImage } from 'lucide-react';

// Данные для страниц
const stages = [
  { key: 'brief', title: 'Бриф', icon: BookOpen, eta: '1–2 дня', progress: 80 },
  { key: 'discovery', title: 'Исследование', icon: BookOpen, eta: '3–5 дней', progress: 60 },
  { key: 'brand', title: 'Брендинг', icon: IconImage, eta: '5–7 дней', progress: 35 },
  { key: 'design', title: 'Дизайн сайта', icon: IconImage, eta: '7–10 дней', progress: 20 },
  { key: 'dev', title: 'Разработка', icon: Rocket, eta: '10–14 дней', progress: 10 },
  { key: 'handoff', title: 'Сдача', icon: CheckCircle2, eta: '1 день', progress: 0 },
];

// Страница авторизации
const AuthPage = ({ onLoginSuccess }) => {
  const [role, setRole] = useState('');
  const [rememberMe, setRememberMe] = useState(false);
  const [login, setLogin] = useState('');
  const [password, setPassword] = useState('');

  const handleLogin = () => {
    if (role && login && password) {
      onLoginSuccess(role);
    } else {
      alert('Заполните все поля!');
    }
  };

  return (
    <div className="auth-page">
      <h2>Авторизация</h2>
      <div>
        <FormControlLabel
          control={<Checkbox checked={role === 'client'} onChange={() => setRole('client')} />}
          label="Заказчик"
        />
        <FormControlLabel
          control={<Checkbox checked={role === 'team'} onChange={() => setRole('team')} />}
          label="Член команды"
        />
      </div>
      <TextField
        label="Логин"
        value={login}
        onChange={(e) => setLogin(e.target.value)}
        fullWidth
      />
      <TextField
        label="Пароль"
        type="password"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
        fullWidth
      />
      <FormControlLabel
        control={<Checkbox checked={rememberMe} onChange={() => setRememberMe(!rememberMe)} />}
        label="Запомнить меня"
      />
      <Button onClick={handleLogin} fullWidth variant="contained">Войти</Button>
    </div>
  );
};

// Страница заказчика (Dashboard)
const ClientDashboard = () => (
  <div>
    <h1>Кабинет заказчика</h1>
    <Grid container spacing={3}>
      <Grid item xs={12} md={8}>
        {stages.map((stage) => (
          <Card key={stage.key}>
            <CardHeader>
              <CardTitle>{stage.title}</CardTitle>
              <CardDescription>ETA: {stage.eta}</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <stage.icon className="w-6 h-6 text-teal-600" />
                  <span>{stage.title}</span>
                </div>
                <div className="flex items-center gap-2">
                  <span>{stage.progress}%</span>
                  <div className="h-2 w-32 rounded-full bg-gray-200">
                    <div className="h-full bg-teal-500" style={{ width: `${stage.progress}%` }} />
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        ))}
      </Grid>
      <Grid item xs={12} md={4}>
        <Card>
          <CardHeader>
            <CardTitle>Мои материалы</CardTitle>
            <CardDescription>Все логотипы, шрифты и цвета проекта</CardDescription>
          </CardHeader>
          <CardContent>
            <Box className="grid grid-cols-2 gap-2">
              <div className="h-24 bg-gray-300 rounded-xl"></div>
              <div className="h-24 bg-gray-300 rounded-xl"></div>
            </Box>
          </CardContent>
        </Card>
      </Grid>
    </Grid>
  </div>
);

// Страница члена команды (Kanban board)
const TeamDashboard = () => (
  <div>
    <h1>Кабинет члена команды</h1>
    <div>
      <h2>Задачи:</h2>
      <Card>
        <CardHeader>
          <CardTitle>Проект 1</CardTitle>
        </CardHeader>
        <CardContent>
          <ul>
            <li>Задача 1</li>
            <li>Задача 2</li>
            <li>Задача 3</li>
          </ul>
        </CardContent>
      </Card>
    </div>
  </div>
);

// Главный компонент для управления состоянием
const App = () => {
  const [role, setRole] = useState('');
  const [authPage, setAuthPage] = useState(true);

  const handleLoginSuccess = (role) => {
    setRole(role);
    setAuthPage(false);
  };

  return (
    <div className="app">
      {authPage ? (
        <AuthPage onLoginSuccess={handleLoginSuccess} />
      ) : role === 'client' ? (
        <ClientDashboard />
      ) : (
        <TeamDashboard />
      )}
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('root'));
