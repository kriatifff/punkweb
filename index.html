import React, { useState, useMemo } from 'react';
import ReactDOM from 'react-dom';

// Моковые данные для этапов проекта
const stages = [
  { key: 'brief', title: 'Бриф', eta: '1–2 дня', progress: 80, color: '#4caf50' },
  { key: 'discovery', title: 'Исследование', eta: '3–5 дней', progress: 60, color: '#2196f3' },
  { key: 'brand', title: 'Брендинг', eta: '5–7 дней', progress: 35, color: '#9c27b0' },
  { key: 'design', title: 'Дизайн сайта', eta: '7–10 дней', progress: 20, color: '#ff9800' },
  { key: 'dev', title: 'Разработка', eta: '10–14 дней', progress: 10, color: '#f44336' },
  { key: 'handoff', title: 'Сдача', eta: '1 день', progress: 0, color: '#9e9e9e' },
];

// Компонент для отображения прогресса этапа
const StagePill = ({ title, eta, progress, color }) => (
  <div style={{ background: color, color: 'white', padding: '15px', borderRadius: '8px', margin: '10px 0', width: '300px' }}>
    <h3>{title}</h3>
    <p>ETA: {eta}</p>
    <div style={{ background: '#ddd', borderRadius: '5px', height: '10px', margin: '10px 0' }}>
      <div style={{ width: `${progress}%`, background: 'white', borderRadius: '5px', height: '100%' }}></div>
    </div>
    <p>Прогресс: {progress}%</p>
  </div>
);

// Моковые данные для участников
const members = [
  { id: 1, name: 'Анна', role: 'Аккаунт-менеджер', initials: 'A' },
  { id: 2, name: 'Илья', role: 'Проджект-лид', initials: 'I' },
  { id: 3, name: 'Мария', role: 'Дизайнер', initials: 'M' },
  { id: 4, name: 'Олег', role: 'Разработчик', initials: 'O' },
  { id: 5, name: 'Кира', role: 'Маркетолог', initials: 'K' },
];

// Компонент для отображения участника
const MemberCard = ({ m }) => (
  <div style={{ display: 'flex', alignItems: 'center', margin: '10px 0', background: '#f4f4f4', padding: '10px', borderRadius: '8px', width: '300px' }}>
    <div style={{ width: '40px', height: '40px', borderRadius: '50%', background: '#007bff', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
      {m.initials}
    </div>
    <div style={{ marginLeft: '15px' }}>
      <div>{m.name}</div>
      <div style={{ fontSize: '12px', color: '#777' }}>{m.role}</div>
    </div>
  </div>
);

// Основной компонент приложения
const App = () => {
  const [activeStage, setActiveStage] = useState(stages[0].key);
  const [role, setRole] = useState(''); // Роль пользователя
  const [login, setLogin] = useState(''); // Логин
  const [password, setPassword] = useState(''); // Пароль
  const [authPage, setAuthPage] = useState(true); // Страница авторизации

  const overallProgress = useMemo(() => Math.round((stages.reduce((acc, s) => acc + s.progress, 0) / (stages.length * 100)) * 100), []);

  const currentStage = stages.find((s) => s.key === activeStage);

  const handleLogin = () => {
    if (role && login && password) {
      setAuthPage(false);
    } else {
      alert('Заполните все поля!');
    }
  };

  return (
    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>
      {/* Страница авторизации */}
      {authPage ? (
        <div>
          <h2>Авторизация</h2>
          <div>
            <label>
              <input type="radio" checked={role === 'client'} onChange={() => setRole('client')} /> Заказчик
            </label>
            <label>
              <input type="radio" checked={role === 'team'} onChange={() => setRole('team')} /> Член команды
            </label>
          </div>
          <input type="text" placeholder="Логин" value={login} onChange={(e) => setLogin(e.target.value)} style={{ padding: '10px', margin: '10px 0', width: '100%' }} />
          <input type="password" placeholder="Пароль" value={password} onChange={(e) => setPassword(e.target.value)} style={{ padding: '10px', margin: '10px 0', width: '100%' }} />
          <button onClick={handleLogin} style={{ padding: '10px 20px', background: '#007bff', color: 'white', border: 'none', borderRadius: '5px', marginTop: '10px' }}>
            Войти
          </button>
        </div>
      ) : (
        <div>
          {/* Страница пользователя в зависимости от его роли */}
          <h1>{role === 'client' ? 'Кабинет заказчика' : 'Кабинет члена команды'}</h1>

          {role === 'client' ? (
            <div>
              {stages.map((stage) => (
                <StagePill key={stage.key} title={stage.title} eta={stage.eta} progress={stage.progress} color={stage.color} />
              ))}
              <h3>Общий прогресс: {overallProgress}%</h3>
            </div>
          ) : (
            <div>
              <h3>Команда проекта</h3>
              {members.map((member) => (
                <MemberCard key={member.id} m={member} />
              ))}
            </div>
          )}
        </div>
      )}
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('root'));
